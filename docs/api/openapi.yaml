openapi: 3.1.0
info:
  title: AIVolution API
  version: 1.0.0
  description: |
    Public REST API exposed via the API Gateway for client integrations.
servers:
  - url: https://api.aivolution.example.com
    description: Production
  - url: https://staging-api.aivolution.example.com
    description: Staging
security:
  - bearerAuth: []
tags:
  - name: Projects
    description: Manage 3D design projects and sessions.
  - name: Assets
    description: Upload and retrieve design and AI-generated assets.
  - name: Inference Jobs
    description: Trigger and monitor AI / 3D processing jobs.
paths:
  /v1/projects:
    get:
      tags: [Projects]
      summary: List projects for the authenticated user.
      operationId: listProjects
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: pageSize
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: Paginated list of projects.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedProjects'
    post:
      tags: [Projects]
      summary: Create a new project.
      operationId: createProject
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProjectRequest'
      responses:
        '201':
          description: Project created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
  /v1/projects/{projectId}:
    parameters:
      - $ref: '#/components/parameters/ProjectId'
    get:
      tags: [Projects]
      summary: Get project details.
      operationId: getProject
      responses:
        '200':
          description: Project details.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
    patch:
      tags: [Projects]
      summary: Update project metadata.
      operationId: updateProject
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProjectRequest'
      responses:
        '200':
          description: Updated project.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Project'
    delete:
      tags: [Projects]
      summary: Archive a project.
      operationId: deleteProject
      responses:
        '204':
          description: Project archived.
  /v1/projects/{projectId}/assets:
    parameters:
      - $ref: '#/components/parameters/ProjectId'
    get:
      tags: [Assets]
      summary: List assets attached to a project.
      operationId: listAssets
      responses:
        '200':
          description: Project assets.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Asset'
    post:
      tags: [Assets]
      summary: Upload a new asset.
      operationId: uploadAsset
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                kind:
                  type: string
                  enum: [reference, ai-generated]
                metadata:
                  type: string
                  description: JSON-encoded metadata.
      responses:
        '201':
          description: Asset uploaded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Asset'
  /v1/inference-jobs:
    post:
      tags: [Inference Jobs]
      summary: Submit a new AI/3D inference job.
      operationId: createInferenceJob
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateInferenceJobRequest'
      responses:
        '202':
          description: Job accepted.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InferenceJob'
    get:
      tags: [Inference Jobs]
      summary: List inference jobs for the authenticated user.
      operationId: listInferenceJobs
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, running, completed, failed]
      responses:
        '200':
          description: List of inference jobs.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/InferenceJob'
  /v1/inference-jobs/{jobId}:
    parameters:
      - $ref: '#/components/parameters/JobId'
    get:
      tags: [Inference Jobs]
      summary: Get job status and result metadata.
      operationId: getInferenceJob
      responses:
        '200':
          description: Job details.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InferenceJob'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  parameters:
    ProjectId:
      name: projectId
      in: path
      required: true
      schema:
        type: string
        format: uuid
    JobId:
      name: jobId
      in: path
      required: true
      schema:
        type: string
        format: uuid
  schemas:
    PaginatedProjects:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Project'
        page:
          type: integer
        pageSize:
          type: integer
        totalItems:
          type: integer
    Project:
      type: object
      required: [id, name, status, createdAt, updatedAt]
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        status:
          type: string
          enum: [active, archived]
        description:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    CreateProjectRequest:
      type: object
      required: [name]
      properties:
        name:
          type: string
        description:
          type: string
        templateId:
          type: string
          format: uuid
          nullable: true
    UpdateProjectRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [active, archived]
    Asset:
      type: object
      required: [id, projectId, kind, uri, createdAt]
      properties:
        id:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        kind:
          type: string
          enum: [reference, ai-generated]
        uri:
          type: string
          format: uri
        metadata:
          type: object
          additionalProperties: true
        createdAt:
          type: string
          format: date-time
    CreateInferenceJobRequest:
      type: object
      required: [projectId, input]
      properties:
        projectId:
          type: string
          format: uuid
        input:
          type: object
          properties:
            prompt:
              type: string
            referenceAssetIds:
              type: array
              items:
                type: string
                format: uuid
            parameters:
              type: object
              additionalProperties:
                type: number
        outputType:
          type: string
          enum: [mesh, texture, animation, analysis]
        webhookUrl:
          type: string
          format: uri
          nullable: true
    InferenceJob:
      type: object
      required: [id, projectId, status, createdAt]
      properties:
        id:
          type: string
          format: uuid
        projectId:
          type: string
          format: uuid
        status:
          type: string
          enum: [pending, running, completed, failed]
        progress:
          type: integer
          minimum: 0
          maximum: 100
        resultAssetId:
          type: string
          format: uuid
          nullable: true
        error:
          type: string
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
